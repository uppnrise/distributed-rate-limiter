<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!-- Suppress EI_EXPOSE_REP2 warnings for Spring dependency injection constructors -->
    <!-- These are legitimate uses where Spring manages the lifecycle -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP2"/>
        <Or>
            <!-- Spring Services with @Autowired constructors - dependency injection -->
            <And>
                <Class name="dev.bnacar.distributedratelimiter.security.ApiKeyService"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.security.IpSecurityService"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.security.SecurityFilter"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.ratelimit.RateLimiterService"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.ratelimit.RedisRateLimiterBackend"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.ratelimit.RedisTokenBucket"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <!-- Spring Configuration classes - dependency injection -->
            <And>
                <Class name="dev.bnacar.distributedratelimiter.config.FilterConfiguration"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <!-- Spring Controllers with dependency injection -->
            <And>
                <Class name="dev.bnacar.distributedratelimiter.controller.AdminController"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.controller.BenchmarkController"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.controller.MetricsController"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.controller.RateLimitConfigController"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.controller.RateLimitController"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <!-- Service classes with dependency injection -->
            <And>
                <Class name="dev.bnacar.distributedratelimiter.ratelimit.ConfigurationResolver"/>
                <Method name="&lt;init&gt;"/>
            </And>
            <And>
                <Class name="dev.bnacar.distributedratelimiter.ratelimit.DistributedRateLimiterService"/>
                <Method name="&lt;init&gt;"/>
            </And>
        </Or>
    </Match>
    
    <!-- Suppress EI_EXPOSE_REP and EI_EXPOSE_REP2 for Spring Configuration Properties -->
    <!-- These classes need to work with Spring's property binding mechanism -->
    <Match>
        <Bug pattern="EI_EXPOSE_REP,EI_EXPOSE_REP2"/>
        <Class name="dev.bnacar.distributedratelimiter.config.SecurityConfiguration"/>
    </Match>
</FindBugsFilter>